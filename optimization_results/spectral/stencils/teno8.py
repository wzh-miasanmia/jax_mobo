coef_smoothness_03_01_ = 1.0
coef_smoothness_03_02_ = -1.0
coef_smoothness_03_03_ = 1.0
coef_smoothness_03_04_ = -2.0
coef_smoothness_03_05_ = 1.0
coef_smoothness_03_1_ = 0.25
coef_smoothness_03_2_ = 13.0 / 12.0

coef_smoothness_13_01_ = 3.0
coef_smoothness_13_02_ = -4.0
coef_smoothness_13_03_ = 1.0
coef_smoothness_13_04_ = 1.0
coef_smoothness_13_05_ = -2.0
coef_smoothness_13_06_ = 1.0
coef_smoothness_13_1_ = 0.25
coef_smoothness_13_2_ = 13.0 / 12.0

coef_smoothness_23_01_ = 1.0
coef_smoothness_23_02_ = -4.0
coef_smoothness_23_03_ = 3.0
coef_smoothness_23_04_ = 1.0
coef_smoothness_23_05_ = -2.0
coef_smoothness_23_06_ = 1.0
coef_smoothness_23_1_ = 0.25
coef_smoothness_23_2_ = 13.0 / 12.0

coef_smoothness_34_01_ = 2107.0
coef_smoothness_34_02_ = -9402.0
coef_smoothness_34_03_ = 7042.0
coef_smoothness_34_04_ = -1854.0
coef_smoothness_34_05_ = 11003.0
coef_smoothness_34_06_ = -17246.0
coef_smoothness_34_07_ = 4642.0
coef_smoothness_34_08_ = 7043.0
coef_smoothness_34_09_ = -3882.0
coef_smoothness_34_10_ = 547.0
coef_smoothness_34_1_ = 1.0 / 240.0

coef_smoothness_44_01_ = 547.0
coef_smoothness_44_02_ = -3882.0
coef_smoothness_44_03_ = 4642.0
coef_smoothness_44_04_ = -1854.0
coef_smoothness_44_05_ = 7043.0
coef_smoothness_44_06_ = -17246.0
coef_smoothness_44_07_ = 7042.0
coef_smoothness_44_08_ = 11003.0
coef_smoothness_44_09_ = -9402.0
coef_smoothness_44_10_ = 2107.0
coef_smoothness_44_1_ = 1.0 / 240.0

coef_smoothness_55_01_ = 107918.0
coef_smoothness_55_02_ = -649501.0
coef_smoothness_55_03_ = 758823.0
coef_smoothness_55_04_ = -411487.0
coef_smoothness_55_05_ = 86329.0
coef_smoothness_55_06_ = 1020563.0
coef_smoothness_55_07_ = -2462076.0
coef_smoothness_55_08_ = 1358458.0
coef_smoothness_55_09_ = -288007.0
coef_smoothness_55_10_ = 1521393.0
coef_smoothness_55_11_ = -1704396.0
coef_smoothness_55_12_ = 364863.0
coef_smoothness_55_13_ = 482963.0
coef_smoothness_55_14_ = -208501.0
coef_smoothness_55_15_ = 22658.0
coef_smoothness_55_1_ = 1.0 / 5040.0

coef_smoothness_8_01_ = 75349098471.0
coef_smoothness_8_02_ = -1078504915264.0
coef_smoothness_8_03_ = 3263178215782.0
coef_smoothness_8_04_ = -5401061230160.0
coef_smoothness_8_05_ = 5274436892970.0
coef_smoothness_8_06_ = -3038037798592.0
coef_smoothness_8_07_ = 956371298594.0
coef_smoothness_8_08_ = -127080660272.0
coef_smoothness_8_09_ = 3944861897609.0
coef_smoothness_8_10_ = -24347015748304.0
coef_smoothness_8_11_ = 41008808432890.0
coef_smoothness_8_12_ = -40666174667520.0
coef_smoothness_8_13_ = 23740865961334.0
coef_smoothness_8_14_ = -7563868580208.0
coef_smoothness_8_15_ = 1016165721854.0

coef_smoothness_8_16_ = 38329064547231.0
coef_smoothness_8_17_ = -131672853704480.0
coef_smoothness_8_18_ = 132979856899250.0
coef_smoothness_8_19_ = -78915800051952.0
coef_smoothness_8_20_ = 25505661974314.0
coef_smoothness_8_21_ = -3471156679072.0
coef_smoothness_8_22_ = 115451981835025.0
coef_smoothness_8_23_ = -238079153652400.0
coef_smoothness_8_24_ = 144094750348910.0
coef_smoothness_8_25_ = -47407534412640.0

coef_smoothness_8_26_ = 6553080547830.0
coef_smoothness_8_27_ = 125494539510175.0
coef_smoothness_8_28_ = -155373333547520.0
coef_smoothness_8_29_ = 52241614797670.0
coef_smoothness_8_30_ = -7366325742800.0
coef_smoothness_8_31_ = 49287325751121.0
coef_smoothness_8_32_ = -33999931981264.0
coef_smoothness_8_33_ = 4916835566842.0
coef_smoothness_8_34_ = 6033767706599.0
coef_smoothness_8_35_ = -1799848509664.0
coef_smoothness_8_36_ = 139164877641.0
coef_smoothness_8_1_ = 1.0 / 62270208000.0

coef_weights_1_ = 0.4336570089737348;
coef_weights_2_ = 0.2193140179474722;
coef_weights_3_ = 0.07144766367542149;
coef_weights_4_ = 0.1302093452983125;
coef_weights_5_ = 0.03089532735084351;
coef_weights_6_ = 0.1144766367542177;

coef_stencils_0_1_ = -1.0 / 6.0
coef_stencils_0_2_ = 5.0 / 6.0
coef_stencils_0_3_ = 2.0 / 6.0

coef_stencils_1_1_ = 2.0 / 6.0
coef_stencils_1_2_ = 5.0 / 6.0
coef_stencils_1_3_ = -1.0 / 6.0

coef_stencils_2_1_ = 2.0 / 6.0
coef_stencils_2_2_ = -7.0 / 6.0
coef_stencils_2_3_ = 11.0 / 6.0

coef_stencils_3_1_ = 3.0 / 12.0
coef_stencils_3_2_ = 13.0 / 12.0
coef_stencils_3_3_ = -5.0 / 12.0
coef_stencils_3_4_ = 1.0 / 12.0

coef_stencils_4_1_ = -3.0 / 12.0
coef_stencils_4_2_ = 13.0 / 12.0
coef_stencils_4_3_ = -23.0 / 12.0
coef_stencils_4_4_ = 25.0 / 12.0

coef_stencils_5_1_ = 12.0 / 60.0
coef_stencils_5_2_ = 77.0 / 60.0
coef_stencils_5_3_ = -43.0 / 60.0
coef_stencils_5_4_ = 17.0 / 60.0
coef_stencils_5_5_ = -3.0 / 60.0

epsilon_teno8a_ = 1.0e-40
CT = 1.0e-7

class TENO8:

    def apply(self, value):
        if not isinstance(value, list):
            raise Exception("Inputs must be a list.")
        elif len(value) != 8:
            raise Exception("Inputs must have at least 5 values.")
        else:
            v1 = value[0]
            v2 = value[1]
            v3 = value[2]
            v4 = value[3]
            v5 = value[4]
            v6 = value[5]
            v7 = value[6]
            v8 = value[7]
        s03_1 = coef_smoothness_03_01_ * v3 + coef_smoothness_03_02_ * v5
        s03_2 = coef_smoothness_03_03_ * v3 + coef_smoothness_03_04_ * v4 + coef_smoothness_03_05_ * v5
        s03 = coef_smoothness_03_1_ * s03_1 * s03_1 + coef_smoothness_03_2_ * s03_2 * s03_2

        s13_1 = coef_smoothness_13_01_ * v4 + coef_smoothness_13_02_ * v5 + coef_smoothness_13_03_ * v6
        s13_2 = coef_smoothness_13_04_ * v4 + coef_smoothness_13_05_ * v5 + coef_smoothness_13_06_ * v6
        s13 = coef_smoothness_13_1_ * s13_1 * s13_1 + coef_smoothness_13_2_ * s13_2 * s13_2

        s23_1 = coef_smoothness_23_01_ * v2 + coef_smoothness_23_02_ * v3 + coef_smoothness_23_03_ * v4
        s23_2 = coef_smoothness_23_04_ * v2 + coef_smoothness_23_05_ * v3 + coef_smoothness_23_06_ * v4
        s23 = coef_smoothness_23_1_ * s23_1 * s23_1 + coef_smoothness_23_2_ * s23_2 * s23_2

        s34_1 = coef_smoothness_34_01_ * v4 + coef_smoothness_34_02_ * v5 + coef_smoothness_34_03_ * v6 + coef_smoothness_34_04_ * v7
        s34_2 = coef_smoothness_34_05_ * v5 + coef_smoothness_34_06_ * v6 + coef_smoothness_34_07_ * v7
        s34_3 = coef_smoothness_34_08_ * v6 + coef_smoothness_34_09_ * v7
        s34_4 = coef_smoothness_34_10_ * v7
        s34 = coef_smoothness_34_1_ * (s34_1 * v4 + s34_2 * v5 + s34_3 * v6 + s34_4 * v7)

        s44_1 = coef_smoothness_44_01_ * v1 + coef_smoothness_44_02_ * v2 + coef_smoothness_44_03_ * v3 + coef_smoothness_44_04_ * v4
        s44_2 = coef_smoothness_44_05_ * v2 + coef_smoothness_44_06_ * v3 + coef_smoothness_44_07_ * v4
        s44_3 = coef_smoothness_44_08_ * v3 + coef_smoothness_44_09_ * v4
        s44_4 = coef_smoothness_44_10_ * v4
        s44 = coef_smoothness_44_1_ * (s44_1 * v1 + s44_2 * v2 + s44_3 * v3 + s44_4 * v4)

        s55_1 = coef_smoothness_55_01_ * v4 + coef_smoothness_55_02_ * v5 + coef_smoothness_55_03_ * v6 + coef_smoothness_55_04_ * v7 + coef_smoothness_55_05_ * v8
        s55_2 = coef_smoothness_55_06_ * v5 + coef_smoothness_55_07_ * v6 + coef_smoothness_55_08_ * v7 + coef_smoothness_55_09_ * v8
        s55_3 = coef_smoothness_55_10_ * v6 + coef_smoothness_55_11_ * v7 + coef_smoothness_55_12_ * v8
        s55_4 = coef_smoothness_55_13_ * v7 + coef_smoothness_55_14_ * v8
        s55_5 = coef_smoothness_55_15_ * v8
        s55 = coef_smoothness_55_1_ * (s55_1 * v4 + s55_2 * v5 + s55_3 * v6 + s55_4 * v7 + s55_5 * v8)

        s8_1 = coef_smoothness_8_01_ * v8 + coef_smoothness_8_02_ * v7 + coef_smoothness_8_03_ * v6 + coef_smoothness_8_04_ * v5 + coef_smoothness_8_05_ * v4 + coef_smoothness_8_06_ * v3 + coef_smoothness_8_07_ * v2 + coef_smoothness_8_08_ * v1
        s8_2 = coef_smoothness_8_09_ * v7 + coef_smoothness_8_10_ * v6 + coef_smoothness_8_11_ * v5 + coef_smoothness_8_12_ * v4 + coef_smoothness_8_13_ * v3 + coef_smoothness_8_14_ * v2 + coef_smoothness_8_15_ * v1
        s8_3 = coef_smoothness_8_16_ * v6 + coef_smoothness_8_17_ * v5 + coef_smoothness_8_18_ * v4 + coef_smoothness_8_19_ * v3 + coef_smoothness_8_20_ * v2 + coef_smoothness_8_21_ * v1
        s8_4 = coef_smoothness_8_22_ * v5 + coef_smoothness_8_23_ * v4 + coef_smoothness_8_24_ * v3 + coef_smoothness_8_25_ * v2 + coef_smoothness_8_26_ * v1
        s8_5 = coef_smoothness_8_27_ * v4 + coef_smoothness_8_28_ * v3 + coef_smoothness_8_29_ * v2 + coef_smoothness_8_30_ * v1
        s8_6 = coef_smoothness_8_31_ * v3 + coef_smoothness_8_32_ * v2 + coef_smoothness_8_33_ * v1
        s8_7 = coef_smoothness_8_34_ * v2 + coef_smoothness_8_35_ * v1
        s8_8 = coef_smoothness_8_36_ * v1
        tau8 = coef_smoothness_8_1_ * (s8_1 * v8 + s8_2 * v7 + s8_3 * v6 + s8_4 * v5 + s8_5 * v4 + s8_6 * v3 + s8_7 * v2 + s8_8 * v1)

        a1 = 1.0 + tau8 / ( s03 + epsilon_teno8a_ )
        a2 = 1.0 + tau8 / ( s13 + epsilon_teno8a_ )
        a3 = 1.0 + tau8 / ( s23 + epsilon_teno8a_ )
        a4 = 1.0 + tau8 / ( s34 + epsilon_teno8a_ )
        a5 = 1.0 + tau8 / ( s44 + epsilon_teno8a_ )
        a6 = 1.0 + tau8 / ( s55 + epsilon_teno8a_ )

        a1 *= ( a1 * a1 )
        a2 *= ( a2 * a2 )
        a3 *= ( a3 * a3 )
        a4 *= ( a4 * a4 )
        a5 *= ( a5 * a5 )
        a6 *= ( a6 * a6 )
        a1 *= a1
        a2 *= a2
        a3 *= a3
        a4 *= a4
        a5 *= a5
        a6 *= a6

        one_a_sum = 1.0 / ( a1 + a2 + a3 + a4 + a5 + a6 )

        b1 = 0.0 if a1 * one_a_sum < CT else 1.0
        b2 = 0.0 if a2 * one_a_sum < CT else 1.0
        b3 = 0.0 if a3 * one_a_sum < CT else 1.0
        b4 = 0.0 if a4 * one_a_sum < CT else 1.0
        b5 = 0.0 if a5 * one_a_sum < CT else 1.0
        b6 = 0.0 if a6 * one_a_sum < CT else 1.0


        Variation1 = coef_stencils_0_1_ * v3 + coef_stencils_0_2_ * v4 + coef_stencils_0_3_ * v5
        Variation2 = coef_stencils_1_1_ * v4 + coef_stencils_1_2_ * v5 + coef_stencils_1_3_ * v6
        Variation3 = coef_stencils_2_1_ * v2 + coef_stencils_2_2_ * v3 + coef_stencils_2_3_ * v4
        Variation4 = coef_stencils_3_1_ * v4 + coef_stencils_3_2_ * v5 + coef_stencils_3_3_ * v6 + coef_stencils_3_4_ * v7
        Variation5 = coef_stencils_4_1_ * v1 + coef_stencils_4_2_ * v2 + coef_stencils_4_3_ * v3 + coef_stencils_4_4_ * v4
        Variation6 = coef_stencils_5_1_ * v4 + coef_stencils_5_2_ * v5 + coef_stencils_5_3_ * v6 + coef_stencils_5_4_ * v7 + coef_stencils_5_5_ * v8

        w1 = coef_weights_1_ * b1
        w2 = coef_weights_2_ * b2
        w3 = coef_weights_3_ * b3
        w4 = coef_weights_4_ * b4
        w5 = coef_weights_5_ * b5
        w6 = coef_weights_6_ * b6

        one_w_sum = 1.0 / ( w1 + w2 + w3 + w4 + w5 + w6 )

        w1_normalized = w1 * one_w_sum
        w2_normalized = w2 * one_w_sum
        w3_normalized = w3 * one_w_sum
        w4_normalized = w4 * one_w_sum
        w5_normalized = w5 * one_w_sum
        w6_normalized = w6 * one_w_sum

        return w1_normalized * Variation1 + w2_normalized * Variation2 + w3_normalized * Variation3 + w4_normalized * Variation4 + w5_normalized * Variation5 + w6_normalized * Variation6

